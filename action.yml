name: Shuttle Run
description: "Runs a shuttle project."

inputs:
  cargo-shuttle-version:
    description: "Use a specific version of Shuttle."
    required: false
    default: ""
  secrets:
    description: "Contents of `Secrets.toml` file."
    required: false
    default: ""

runs:
  using: "composite"

  steps:
    - name: Install binstall.
      uses: cargo-bins/cargo-binstall@main

      
    - name: Install cargo-shuttle.
      if: ${{ inputs.cargo-shuttle-version == '' }}
      run: cargo binstall -y --locked cargo-shuttle
      shell: bash

    - name: Install cargo-shuttle with specific version.
      if: ${{ inputs.cargo-shuttle-version != '' }}
      run: cargo binstall -y --locked cargo-shuttle@${{ inputs.cargo-shuttle-version }}
      shell: bash
    

    - name: Create secrets.toml.
      if: ${{ inputs.secrets != '' }}
      run: echo "${{ inputs.secrets }}" > Secrets.toml
      shell: bash

    - name: Run project.
      run: cargo shuttle run
      shell: bash
